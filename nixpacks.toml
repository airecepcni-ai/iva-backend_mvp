# Nixpacks configuration for Railway deployment
# Ensures Playwright Chromium browser is installed at build time

[phases.setup]
# NOTE: These must be valid Nix package names (not Debian/apt package names).
# Keep this minimal: Nix chromium brings its runtime deps (incl. glib) and is usable via PATH.
nixPkgs = ["nodejs_20", "chromium", "glib"]

[phases.install]
cmds = [
  "npm ci || npm install",
  "npx playwright install --with-deps chromium || npx playwright install chromium || echo 'Playwright install attempted'"
]

[phases.build]
cmds = ["npm run build || echo 'No build step'"]

[start]
cmd = "npm start"

[variables]
PLAYWRIGHT_BROWSERS_PATH = "0"
PLAYWRIGHT_SKIP_BROWSER_DOWNLOAD = "false"

