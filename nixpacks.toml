# Nixpacks configuration for Railway deployment
# Ensures Playwright Chromium browser is installed at build time

[phases.setup]
nixPkgs = ["nodejs_20", "chromium", "libnss3", "libatk-bridge2.0-0", "libcups2", "libdrm2", "libxkbcommon0", "libxcomposite1", "libxdamage1", "libxrandr2", "libgbm1", "libasound2"]

[phases.install]
cmds = [
  "npm ci || npm install",
  "npx playwright install --with-deps chromium || npx playwright install chromium || echo 'Playwright install attempted'"
]

[phases.build]
cmds = ["npm run build || echo 'No build step'"]

[start]
cmd = "npm start"

[variables]
PLAYWRIGHT_BROWSERS_PATH = "0"
PLAYWRIGHT_SKIP_BROWSER_DOWNLOAD = "false"

